<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Records & Treatment Tracking - EWOC</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/pages/medical-records-tracking.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <div id="navbar-placeholder"></div>

    <!-- Page Header -->
    <header class="page-header">
        <div class="container">
            <h1><i class="fas fa-notes-medical"></i> Medical Records & Treatment Tracking</h1>
            <p>Comprehensive health records, medication schedules, and veterinary care management</p>
        </div>
    </header>

    <!-- Medication Alerts -->
    <section class="alerts-section">
        <div class="container">
            <h2><i class="fas fa-pills"></i> Medication & Treatment Alerts</h2>
            <div class="alerts-grid" id="medicationAlertsGrid">
                <!-- Alerts will be populated dynamically -->
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-heartbeat"></i>
                    <h3 id="statActivePatients">0</h3>
                    <p>Active Patients</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-syringe"></i>
                    <h3 id="statPendingMeds">0</h3>
                    <p>Pending Medications</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-calendar-check"></i>
                    <h3 id="statUpcomingVetVisits">0</h3>
                    <p>Upcoming Vet Visits</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-flask"></i>
                    <h3 id="statPendingLabResults">0</h3>
                    <p>Pending Lab Results</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openMedicalRecordModal()">
                    <i class="fas fa-plus"></i> New Medical Record
                </button>
                <button class="btn btn-secondary" onclick="openPrescriptionModal()">
                    <i class="fas fa-prescription"></i> Add Prescription
                </button>
                <button class="btn btn-secondary" onclick="openVetVisitModal()">
                    <i class="fas fa-stethoscope"></i> Schedule Vet Visit
                </button>
                <button class="btn btn-secondary" onclick="showView('records')">
                    <i class="fas fa-folder-open"></i> Medical Records
                </button>
                <button class="btn btn-secondary" onclick="showView('medications')">
                    <i class="fas fa-pills"></i> Medications
                </button>
                <button class="btn btn-secondary" onclick="showView('treatments')">
                    <i class="fas fa-procedures"></i> Treatment Plans
                </button>
                <button class="btn btn-secondary" onclick="exportMedicalReport()">
                    <i class="fas fa-file-medical"></i> Export Report
                </button>
            </div>

            <!-- Medical Records View -->
            <section id="recordsView" class="view-section">
                <h2><i class="fas fa-folder-open"></i> Animal Medical Records</h2>
                <div class="search-filter-bar">
                    <input type="text" id="searchAnimals" placeholder="Search by name or ID..." onkeyup="filterRecords()">
                    <select id="statusFilter" onchange="filterRecords()">
                        <option value="all">All Status</option>
                        <option value="active">Active Treatment</option>
                        <option value="stable">Stable</option>
                        <option value="critical">Critical</option>
                        <option value="recovered">Recovered</option>
                    </select>
                </div>
                <div class="records-grid" id="recordsGrid">
                    <!-- Records will be populated dynamically -->
                </div>
            </section>

            <!-- Medications View -->
            <section id="medicationsView" class="view-section" style="display: none;">
                <h2><i class="fas fa-pills"></i> Medication Schedule</h2>
                <div class="medication-calendar">
                    <div class="calendar-header">
                        <button class="btn-nav" onclick="changeMedDay(-1)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <h3 id="currentMedDate">Today</h3>
                        <button class="btn-nav" onclick="changeMedDay(1)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    <div class="medication-timeline" id="medicationTimeline">
                        <!-- Timeline will be populated dynamically -->
                    </div>
                </div>
            </section>

            <!-- Treatment Plans View -->
            <section id="treatmentsView" class="view-section" style="display: none;">
                <h2><i class="fas fa-procedures"></i> Active Treatment Plans</h2>
                <div class="treatments-grid" id="treatmentsGrid">
                    <!-- Treatment plans will be populated dynamically -->
                </div>
            </section>
        </div>
    </main>

    <!-- New Medical Record Modal -->
    <div id="medicalRecordModal" class="modal">
        <div class="modal-content large">
            <span class="close" onclick="closeMedicalRecordModal()">&times;</span>
            <h2><i class="fas fa-file-medical"></i> New Medical Record</h2>
            
            <form id="medicalRecordForm" onsubmit="submitMedicalRecord(event)">
                <!-- Animal Information -->
                <div class="form-section">
                    <h3>Animal Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="animalId">Animal ID/Name*</label>
                            <input type="text" id="animalId" required>
                        </div>
                        <div class="form-group">
                            <label for="animalSpecies">Species*</label>
                            <select id="animalSpecies" required>
                                <option value="">Select Species</option>
                                <option value="dog">Dog</option>
                                <option value="cat">Cat</option>
                                <option value="bird">Bird</option>
                                <option value="rabbit">Rabbit</option>
                                <option value="wildlife">Wildlife</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="animalAge">Age</label>
                            <input type="text" id="animalAge">
                        </div>
                    </div>
                </div>

                <!-- Medical Assessment -->
                <div class="form-section">
                    <h3>Medical Assessment</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="temperature">Temperature (Â°F)</label>
                            <input type="number" id="temperature" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (lbs)</label>
                            <input type="number" id="weight" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="heartRate">Heart Rate (bpm)</label>
                            <input type="number" id="heartRate">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="primaryDiagnosis">Primary Diagnosis*</label>
                        <input type="text" id="primaryDiagnosis" required>
                    </div>
                    <div class="form-group">
                        <label for="symptoms">Symptoms</label>
                        <textarea id="symptoms" rows="3"></textarea>
                    </div>
                </div>

                <!-- Medical Conditions -->
                <div class="form-section">
                    <h3>Medical Conditions</h3>
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="condition" value="parasites"> Parasites</label>
                        <label><input type="checkbox" name="condition" value="infection"> Infection</label>
                        <label><input type="checkbox" name="condition" value="injury"> Injury/Trauma</label>
                        <label><input type="checkbox" name="condition" value="malnutrition"> Malnutrition</label>
                        <label><input type="checkbox" name="condition" value="respiratory"> Respiratory Issues</label>
                        <label><input type="checkbox" name="condition" value="dental"> Dental Issues</label>
                        <label><input type="checkbox" name="condition" value="skin"> Skin Condition</label>
                        <label><input type="checkbox" name="condition" value="chronic"> Chronic Condition</label>
                    </div>
                </div>

                <!-- Treatment Plan -->
                <div class="form-section">
                    <h3>Treatment Plan</h3>
                    <div class="form-group">
                        <label for="treatmentPlan">Treatment Description*</label>
                        <textarea id="treatmentPlan" rows="4" required></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="treatmentDuration">Duration (days)</label>
                            <input type="number" id="treatmentDuration">
                        </div>
                        <div class="form-group">
                            <label for="followUpDate">Follow-up Date</label>
                            <input type="date" id="followUpDate">
                        </div>
                    </div>
                </div>

                <!-- Veterinarian Info -->
                <div class="form-section">
                    <h3>Veterinarian Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="vetName">Veterinarian Name</label>
                            <input type="text" id="vetName">
                        </div>
                        <div class="form-group">
                            <label for="vetClinic">Clinic</label>
                            <input type="text" id="vetClinic">
                        </div>
                    </div>
                </div>

                <!-- Medical Files Upload -->
                <div class="form-section">
                    <h3>Medical Documents</h3>
                    <div class="form-group">
                        <label for="medicalFiles">Upload Lab Results, X-rays, etc.</label>
                        <input type="file" id="medicalFiles" multiple accept=".pdf,.jpg,.jpeg,.png">
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeMedicalRecordModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Record</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Prescription Modal -->
    <div id="prescriptionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePrescriptionModal()">&times;</span>
            <h2><i class="fas fa-prescription"></i> Add Prescription</h2>
            
            <form id="prescriptionForm" onsubmit="submitPrescription(event)">
                <div class="form-group">
                    <label for="prescriptionAnimal">Animal*</label>
                    <select id="prescriptionAnimal" required>
                        <option value="">Select Animal</option>
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="medicationName">Medication Name*</label>
                    <input type="text" id="medicationName" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="dosage">Dosage*</label>
                        <input type="text" id="dosage" required placeholder="e.g., 10mg">
                    </div>
                    <div class="form-group">
                        <label for="frequency">Frequency*</label>
                        <select id="frequency" required>
                            <option value="">Select</option>
                            <option value="once-daily">Once Daily</option>
                            <option value="twice-daily">Twice Daily</option>
                            <option value="three-times-daily">Three Times Daily</option>
                            <option value="every-8-hours">Every 8 Hours</option>
                            <option value="every-6-hours">Every 6 Hours</option>
                            <option value="as-needed">As Needed</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="startDate">Start Date*</label>
                        <input type="date" id="startDate" required>
                    </div>
                    <div class="form-group">
                        <label for="endDate">End Date*</label>
                        <input type="date" id="endDate" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="administrationRoute">Route*</label>
                    <select id="administrationRoute" required>
                        <option value="">Select</option>
                        <option value="oral">Oral</option>
                        <option value="injection">Injection</option>
                        <option value="topical">Topical</option>
                        <option value="eye-drops">Eye Drops</option>
                        <option value="ear-drops">Ear Drops</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="prescribedBy">Prescribed By</label>
                    <input type="text" id="prescribedBy">
                </div>
                <div class="form-group">
                    <label for="specialInstructions">Special Instructions</label>
                    <textarea id="specialInstructions" rows="3"></textarea>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closePrescriptionModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Prescription</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Schedule Vet Visit Modal -->
    <div id="vetVisitModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeVetVisitModal()">&times;</span>
            <h2><i class="fas fa-stethoscope"></i> Schedule Vet Visit</h2>
            
            <form id="vetVisitForm" onsubmit="submitVetVisit(event)">
                <div class="form-group">
                    <label for="visitAnimal">Animal*</label>
                    <select id="visitAnimal" required>
                        <option value="">Select Animal</option>
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="visitType">Visit Type*</label>
                    <select id="visitType" required>
                        <option value="">Select Type</option>
                        <option value="checkup">Routine Checkup</option>
                        <option value="vaccination">Vaccination</option>
                        <option value="surgery">Surgery</option>
                        <option value="emergency">Emergency</option>
                        <option value="follow-up">Follow-up</option>
                        <option value="dental">Dental</option>
                        <option value="lab-work">Lab Work</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="visitDate">Date*</label>
                        <input type="date" id="visitDate" required>
                    </div>
                    <div class="form-group">
                        <label for="visitTime">Time*</label>
                        <input type="time" id="visitTime" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="visitVet">Veterinarian</label>
                    <input type="text" id="visitVet">
                </div>
                <div class="form-group">
                    <label for="visitClinic">Clinic</label>
                    <input type="text" id="visitClinic">
                </div>
                <div class="form-group">
                    <label for="visitReason">Reason for Visit</label>
                    <textarea id="visitReason" rows="3"></textarea>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeVetVisitModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Schedule Visit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Medical Record Details Modal -->
    <div id="recordDetailsModal" class="modal">
        <div class="modal-content large">
            <span class="close" onclick="closeRecordDetailsModal()">&times;</span>
            <div id="recordDetailsContent">
                <!-- Details will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-placeholder"></div>

    <!-- Scripts -->
    <script src="../js/global/navbar.js"></script>
    <script src="../js/global/footer.js"></script>
    <script src="../js/pages/medical-records-tracking.js"></script>
</body>
</html>
